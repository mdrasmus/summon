CC = g++
AR = ar

INCLUDE = \
    -I$(SRCPREFIX)/Common \
    -I$(SRCPREFIX)/GlutMVC \
    -I$(SRCPREFIX)/MVC 

MY_LIBS = \
        $(SRCPREFIX)/Common/libCommon.a \
        $(SRCPREFIX)/GlutMVC/libGlutMVC.a \
        $(SRCPREFIX)/MVC/libMVC.a 

#  -DNDEBUG

COMPILE = -c -g \
    -Wall -g -fno-strict-aliasing -O2 -fPIC  \
    $(INCLUDE) 

# Profiling code
ifdef PROFILE
    COMPILE := $(COMPILE) -pg 
endif

#
# Python COMPILE flags
#
COMPILE := $(COMPILE) -I/usr/include/python2.4 -I/usr/include/python2.5

# test compiling
test:
	echo $(COMPILE)


# rules for subsystems
$(SRCPREFIX)/Common/libCommon.a:
	make -C $(SRCPREFIX)/Common CFLAGS=$(CFLAGS)
    
$(SRCPREFIX)/GlutMVC/libGlutMVC.a:
	make -C $(SRCPREFIX)/GlutMVC CFLAGS=$(CFLAGS)

$(SRCPREFIX)/MVC/libMVC.a:
	make -C $(SRCPREFIX)/MVC CFLAGS=$(CFLAGS)



# basic compile rule
$(OBJS): %.o: %.cpp
	$(CC) $(CFLAGS) $(COMPILE) -o $@ $<

# basic library building
$(LIB): $(OBJS)
	$(AR) -r $(LIB) $(OBJS)

# basic clean rule
clean:
	rm -rf $(OBJS) $(LIB) $(PROG)

cleanobj:
	rm -rf $(OBJS) $(LIB)

cleanall:
	make clean -C $(SRCPREFIX)/Common
	make clean -C $(SRCPREFIX)/GlutMVC
	make clean -C $(SRCPREFIX)/MVC
	make clean -C $(SRCPREFIX)/Summon

cleanallobj:
	make cleanobj -C $(SRCPREFIX)/Common
	make cleanobj -C $(SRCPREFIX)/GlutMVC
	make cleanobj -C $(SRCPREFIX)/MVC
	make cleanobj -C $(SRCPREFIX)/Summon

